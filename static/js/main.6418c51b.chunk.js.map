{"version":3,"sources":["config/intrateam/logo_IntraTeam.png","config/index.js","officegraph/authHelper.js","Alarms.js","serviceWorker.js","index.js","officegraph/index.js"],"names":["module","exports","clientId","scopes","title","isAnomyous","rss","currentAlerts","components","header","style","borderBottom","display","margin","height","padding","src","logo","marginLeft","fontSize","lineHeight","getAccessToken","replyUrl","window","location","protocol","hostname","port","pathname","console","log","msalConfig","auth","config","redirectUri","storeAuthStateInCookie","authority","msalApplication","UserAgentApplication","Promise","resolve","reject","a","requestObj","handleRedirectCallback","error","response","acquireTokenSilent","authResponse","accessToken","errorCode","getAccount","getLoginInProgress","loops","sessionStorage","getItem","parseInt","setItem","clear","reload","loginRedirect","initializeIcons","ZTICKYBAR","tools","setNotificationCount","tileId","count","target","self","top","postMessage","action","key","_key","_targetOrigin","this","_openerHref","_tileId","init","Boolean","match","ReactDOM","render","SCOPES","LOCALSTORAGE_SEENALERTS","useState","isSignedIn","errors","setErrors","me","setMe","alerts","setAlerts","seenAlerts","setSeenAlerts","inFrame","e","inIframe","setAccessToken","refresh","setRefresh","isProcessing","setIsProcessing","unreadCount","setUnreadCount","getRSS","AuthHelper","token","OfficeGraph","get","push","context","useEffect","ztickyBarNotificationCount","localStorage","load","extensionName","then","extensionData","getAlerts","catch","position","length","MessageBar","messageBarType","MessageBarType","isMultiline","onDismiss","slice","dismissButtonAriaLabel","JSON","stringify","backgroundColor","marginRight","maxWidth","textAlign","marginTop","PrimaryButton","text","onClick","alert","map","className","fontWeight","read","cursor","id","url","date","moment","utc","saveSeenAlerts","flexGrow","message","format","bottom","width","displayName","userPrincipalName","alertsUrl","href","c","Button","packageData","version","_seenAlerts","data","alertIds","_alerts","x","fields","Title","active","Active","Date","Message","image","RollupImage","Url","newSeenAlerts","forEach","seen","ztickyBar","document","parse","axios","channel","item","i1","i2","i3","guid","pubDate","description","link","extension","patch","etag","post","getElementById","navigator","serviceWorker","ready","registration","unregister","request","require","tokenEndpoint","requestParams","grant_type","client_id","client_secret","clientSecret","resource","form","err","body","parsedBody","error_description","access_token","getRaw","headers","authorization","hasError","result","cb","appendTo","index","retrycount","errCounter","concat","value","payload"],"mappings":"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","file":"static/js/main.6418c51b.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","import React from \"react\";\nimport logo from \"./intrateam/logo_IntraTeam.png\";\n\nexport default {\n  clientId: \"443ae28d-8cf8-42fd-ba63-f403ac085ead\",\n  scopes: [\"user.readwrite\",\"Sites.Read.All\"],\n  title: \"IntraTeam Notifier\",\n  isAnomyous: true,\n  rss:\"https://intrateamzbar.blob.core.windows.net/webflow/redirects.json\",\n  currentAlerts:\"https://graph.microsoft.com/v1.0/sites/christianiabpos.sharepoint.com:/sites/intranets-corp:/lists/currentAlerts/items?expand=fields\",\n  components: {\n    header: (\n      <div style={{ borderBottom: \"1px solid #cccccc\" }}>\n        <div style={{ display: \"flex\", margin: \"20px\" }}>\n          <div>\n            <img style={{ height: \"20px\", padding: \"4px\" }} src={logo} />\n          </div>\n          <div\n            style={{\n              marginLeft: \"16px\",\n              fontSize: \"20px\",\n              lineHeight: \"20px\",\n              padding: \"4px\"\n            }}\n          >\n            Notifications\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n};\n","import { UserAgentApplication } from \"msal\";\r\nimport config from \"../config\";\r\nfunction getAccessToken(scopes) {\r\n  var replyUrl =\r\n    window.location.protocol +\r\n    \"//\" +\r\n    window.location.hostname +\r\n    (window.location.port !== 80 &&\r\n    window.location.port !== 443 &&\r\n    window.location.port !== \"\"\r\n      ? \":\" + window.location.port\r\n      : \"\") +\r\n    window.location.pathname;\r\n  console.log(\"login replyUrl\", replyUrl);\r\n  var msalConfig = {\r\n    auth: {\r\n      clientId: config.clientId,\r\n      redirectUri: replyUrl,\r\n      storeAuthStateInCookie: true,\r\n      authority: \"https://login.microsoftonline.com/common\"\r\n    }\r\n  };\r\n  var msalApplication = new UserAgentApplication(msalConfig);\r\n\r\n  return new Promise(async (resolve, reject) => {\r\n    var requestObj = {\r\n      scopes\r\n    };\r\n\r\n    msalApplication.handleRedirectCallback((error, response) => {\r\n      // handle redirect response or error\r\n    });\r\n    //debugger\r\n    // if (!msalApplication.getAccount()) {\r\n    //   msalApplication.loginRedirect(requestObj);\r\n    // }\r\n    try {\r\n      const authResponse = await msalApplication.acquireTokenSilent(requestObj);\r\n      resolve(authResponse.accessToken);\r\n    } catch (error) {\r\n      //debugger\r\n      switch (error.errorCode) {\r\n        case \"user_login_error\":\r\n          if (\r\n            !msalApplication.getAccount() &&\r\n            !msalApplication.getLoginInProgress()\r\n          ) {\r\n            var loops = sessionStorage.getItem(\"loops\")\r\n              ? parseInt(sessionStorage.getItem(\"loops\"))\r\n              : 0;\r\n            if (loops > 3) {\r\n              sessionStorage.setItem(\"loops\", 0);\r\n              sessionStorage.clear();\r\n              window.location.reload();\r\n            }\r\n            sessionStorage.setItem(\"loops\", loops + 1);\r\n            msalApplication.loginRedirect(requestObj);\r\n          }\r\n\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n\r\n      reject(error);\r\n    }\r\n  });\r\n}\r\n\r\nexport default {\r\n  getAccessToken\r\n};\r\n","/******************************************************************************************************************************\nZTICKYBAR Notifier\n\nCopyright (c) jumpto365, Inc\n\nAll rights reserved.\n\nMIT License\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n \n------------------------------------------------------------------------------------------------------------------------------\n \n Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019 - Februar 2020\n\n *******************************************************************************************************************************/\nimport React, { useState, useEffect } from \"react\";\nimport _ from \"lodash\";\nimport config from \"./config\";\nimport { initializeIcons } from \"@uifabric/icons\";\nimport AuthHelper from \"./officegraph/authHelper\";\nimport OfficeGraph from \"./officegraph\";\nimport moment from \"moment\";\nimport {\n  MessageBar,\n  MessageBarType,\n  PrimaryButton,\n  Button,\n  getScreenSelector\n} from \"office-ui-fabric-react\";\nimport \"./App.css\";\nimport packageData from \"../package.json\";\nimport axios from \"axios\"\ninitializeIcons();\n\nfunction inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\n\n/******************************************************************************************************************************\n *\n * Proxied class\n *\n ******************************************************************************************************************************/\nclass ZTICKYBAR {\n  static init = () => {\n    return new ZTICKYBAR();\n  };\n  constructor() {\n    this._key = \"123\";\n    this._targetOrigin = \"*\";\n  }\n\n  /******************************************************************************************************************************\n   *\n   * Returns a promise of returning an array of tiles\n   *\n   ******************************************************************************************************************************/\n  tools = () => {\n    return new Promise((resolve, reject) => {\n      resolve([]);\n    });\n  };\n  /******************************************************************************************************************************\n   *\n   * setNotificationCount Update the visual notification counter on a given tile\n   * @param {*} tileId Number of the tile\n   * @param {*} count  Count to set, only whole numbers (integers) are accepted. Setting the value to 0 will hide the notification counter\n   *\n   ******************************************************************************************************************************/\n  setNotificationCount = (tileId, count) => {\n    var target = window.self !== window.top ? window.top : window.self;\n    if (target) {\n      target.postMessage(\n        {\n          action: \"setNotificationCount\",\n          count,\n          tileId,\n          key: this._key\n        },\n        this._targetOrigin\n      );\n    }\n  };\n  get openerHref() {\n    return this._openerHref;\n  }\n  get tileId() {\n    return this._tileId;\n  }\n}\n\n/**\n *\n *\n *\n */\nexport default function Alerts() {\n  const SCOPES = [\"User.ReadWrite\", \"Sites.Read.All\"];\n  const LOCALSTORAGE_SEENALERTS = \"seenalerts\";\n  const [isSignedIn, setIsSignedIn] = useState(true);\n\n  const [errors, setErrors] = useState([]);\n  const [me, setMe] = useState({});\n  const [alerts, setAlerts] = useState([]);\n  const [seenAlerts, setSeenAlerts] = useState([]);\n  const inFrame = inIframe();\n  const [accessToken, setAccessToken] = useState(\"\");\n  const [refresh, setRefresh] = useState(0);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [unreadCount, setUnreadCount] = useState(0);\n\n  /******************************************************************************************************************************\n   *\n   * Decrease the number of unseen alerts\n   *\n   * (DEBUGGING FUNCTION)\n   ******************************************************************************************************************************/\n  const down = () => {\n    var c = localStorage.getItem(\"ztickyBarNotificationCount\");\n    var count = c ? (parseInt(c) > 0 ? parseInt(c) - 1 : 1) : 0;\n    localStorage.setItem(\"ztickyBarNotificationCount\", count);\n\n    var ztickyBar = ZTICKYBAR.init();\n    ztickyBar.setNotificationCount(3, count);\n  };\n  /******************************************************************************************************************************\n   *\n   * Increase the number of unseen alerts\n   *\n   * (DEBUGGING FUNCTION)\n   ******************************************************************************************************************************/\n\n  const up = () => {\n    var c = localStorage.getItem(\"ztickyBarNotificationCount\");\n    var count = c ? (parseInt(c) > 0 ? parseInt(c) + 1 : 1) : 0;\n    localStorage.setItem(\"ztickyBarNotificationCount\", count);\n\n    var ztickyBar = ZTICKYBAR.init();\n    ztickyBar.setNotificationCount(3, count);\n  };\n\n  /******************************************************************************************************************************\n   *\n   * Initial page load\n   *\n   ******************************************************************************************************************************/\n\n  async function load() {\n    try {\n      if (config.isAnomyous){\n        getRSS([])\n        return\n      }\n      var token = await AuthHelper.getAccessToken(SCOPES);\n\n      setAccessToken(token);\n      var me = await OfficeGraph.get(\n        token,\n        \"https://graph.microsoft.com/v1.0/me\"\n      );\n\n      setMe(me);\n    } catch (error) {\n      switch (error.errorCode) {\n        case \"user_login_error\":\n          //debugger;\n          break;\n\n        default:\n          //debugger;\n          break;\n      }\n\n      errors.push({\n        context: \" OfficeGraph.auth.getAccessToken()\",\n        error\n      });\n      setErrors(errors);\n    }\n  }\n  /******************************************************************************************************************************\n   *\n   * Update the UI when necessary\n   *\n   ******************************************************************************************************************************/\n\n  useEffect(() => {\n    var ztickyBar = ZTICKYBAR.init();\n    var ztickyBarNotificationCount = localStorage.getItem(\n      \"ztickyBarNotificationCount\"\n    );\n    var count = ztickyBarNotificationCount\n      ? parseInt(ztickyBarNotificationCount)\n      : 0;\n    // ztickyBar.setNotificationCount(3, count);\n    // return;\n    load();\n    if (accessToken) {\n      getSeenAlerts();\n      //getAlerts();\n    }\n  }, [accessToken, refresh]);\n  /******************************************************************************************************************************\n   * ******************************************************************************************************************************\n   *\n   *     MAIN display\n   *\n   *******************************************************************************************************************************\n   ******************************************************************************************************************************/\n\n  return (\n    <div style={{ position: \"relative\", height: \"95vh\" }}>\n      {/**********************************************************************************************************************\n       *\n       * If the page is not shown in an iFrame, show a custom header\n       *\n       *********************************************************************************************************************/}\n      {!inFrame &&\n        config.components &&\n        config.components.header &&\n        config.components.header}\n      {/**********************************************************************************************************************\n       *\n       * If errors has occured, show on at a time\n       *\n       *********************************************************************************************************************/}\n      {errors.length > 0 && (\n        <MessageBar\n          messageBarType={MessageBarType.error}\n          isMultiline={false}\n          onDismiss={() => {\n            setErrors(errors.slice(1));\n          }}\n          dismissButtonAriaLabel=\"Close\"\n        >\n          Error: {JSON.stringify(errors[0])}\n        </MessageBar>\n      )}\n      <div style={{ backgroundColor: \"#eeeeee\" }}>\n        <div\n          style={{\n            padding: \"20px\",\n            marginLeft: \"auto\",\n            marginRight: \"auto\",\n            maxWidth: \"1280px\",\n            backgroundColor: \"#ffffff\",\n            height: \"80vh\"\n          }}\n        >\n          {/**********************************************************************************************************************\n           *\n           * If not signed in, show a Sign In button\n           *\n           *********************************************************************************************************************/}\n          {!isSignedIn && (\n            <div style={{ textAlign: \"center\", marginTop: \"30vh\" }}>\n              <PrimaryButton\n                text=\"Sign in\"\n                onClick={() => {\n                  alert(\"Not implemented\");\n                }}\n              ></PrimaryButton>\n            </div>\n          )}\n          {/**********************************************************************************************************************\n           *\n           * And finally show the alerts\n           *\n           *********************************************************************************************************************/}\n          {showAlerts()}\n        </div>\n      </div>\n      {/**********************************************************************************************************************\n       *\n       * Debugging stuff, only visible when not in an iframe\n       *\n       *********************************************************************************************************************/}\n      {!inFrame && (\n        <div style={{ position: \"absolute\", bottom: 0 }}>\n          <div style={{ display: \"flex\", width: \"100vw\" }}>\n            <div style={{ flexGrow: 1, padding: 8 }}>\n              {me && (\n                <div>\n                  {me.displayName} ({me.userPrincipalName})\n                </div>\n              )}\n              {config.alertsUrl && (\n                <a href={config.alertsUrl} target=\"_blank\">\n                  {config.alertsUrl}\n                </a>\n              )}\n              <div>\n                <button onClick={up}>+</button>\n                <button onClick={down}>-</button>\n              </div>\n            </div>\n            <div style={{ flexGrow: 1 }}>\n              <div>Unread: {unreadCount}</div>\n              <div>\n                <Button\n                  text=\"clear\"\n                  onClick={() => {\n                    saveSeenAlerts([]);\n                  }}\n                /> <Button\n                text=\"clear session\"\n                onClick={() => {\n                  sessionStorage.clear()\n                  window.location.reload()\n                  \n                }}\n              />\n              </div>\n              {JSON.stringify(seenAlerts)}\n            </div>\n            <div style={{ padding: 8, textAlign: \"right\" }}>\n              <div><a href=\"https://www.jumpto365.com\" target=\"_blank\">ZTICKYBAR Notifier</a></div>\n              <div>Version {packageData.version}</div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n\n  /******************************************************************************************************************************\n   *\n   * Shows the current alerts\n   *\n   ******************************************************************************************************************************/\n  function showAlerts() {\n    return alerts.map((alert, key) => {\n      return (\n        <div className=\"alert\">\n          <div\n            style={{\n              fontWeight: alert.read ? 300 : 600,\n              display: \"flex\",\n              cursor: isProcessing ? \"wait\" : \"pointer\"\n            }}\n            onClick={() => {\n              if (isProcessing) return;\n              if (!alert.read) {\n                setIsProcessing(true);\n                seenAlerts.push({\n                  id: alert.id,\n                  url: alert.url,\n                  date: moment.utc()\n                });\n                saveSeenAlerts(seenAlerts)\n                  .then(() => {\n                    setIsProcessing(false);\n                  })\n                  .catch(() => {\n                    setIsProcessing(false);\n                  });\n              }\n            }}\n          >\n            {/* <div>\n              <img\n                style={{ width: \"80px\", padding: \"10px\" }}\n                src={\n                  alert.image\n                    ? alert.image\n                    : \"https://www.huntersglenvet.com/wp-content/uploads/2018/03/xpop-up-alert.png.pagespeed.ic_.vwzzZnK_Rf-288x300.png\"\n                }\n              ></img>\n            </div> */}\n            <div style={{ position: \"relative\", flexGrow: 1 }}>\n              <div\n                style={{\n                  fontSize: \"24px\",\n                  padding: \"10px\"\n                }}\n              >\n                {alert.title}\n              </div>\n              <div style={{ fontSize: \"12px\", padding: \"10px\" }}>\n                {alert.message}\n              </div>\n              <div\n                style={{\n                  fontSize: \"12px\",\n                  // position: \"absolute\",\n                  // bottom: 0,\n                  padding: \"10px\"\n                }}\n              >\n                Last updated: {moment(alert.date).format(\"LLLL\")}\n              </div>\n            </div>\n            {/* <div>\n              {alert.url && (\n                <a href={alert.url} target=\"_blank\">\n                  Details\n                </a>\n              )}\n            </div> */}\n          </div>\n        </div>\n      );\n    });\n  }\n  /******************************************************************************************************************************\n   *\n   * Load current alerts\n   *\n   ******************************************************************************************************************************/\n  function getAlerts(_seenAlerts) {\n    OfficeGraph.get(\n      accessToken,\n      config.currentAlerts\n      //\"https://graph.microsoft.com/v1.0/sites/christianiabpos.sharepoint.com:/sites/intranets-corp:/lists/currentAlerts/items?expand=fields\"\n    )\n\n      .then(data => {\n        var alertIds = {};\n        if (!data) return;\n\n        var _alerts = data.map(alert => {\n          try {\n            var x = {\n              id: alert.fields.id,\n              title: alert.fields.Title,\n              active: alert.fields.Active,\n              date: alert.fields.Date,\n              message: alert.fields.Message,\n              image: alert.fields.RollupImage\n                ? alert.fields.RollupImage.Url\n                : null,\n              url: alert.fields.Url ? alert.fields.Url.Url : null\n            };\n            alertIds[alert.fields.id] = x;\n            return x;\n          } catch (error) {\n            errors.push({ context: \"OfficeGraph.getAlerts() map \", error });\n            setErrors(errors);\n          }\n        });\n        //debugger\n        var newSeenAlerts = [];\n        if (_seenAlerts) {\n          _seenAlerts.forEach(seen => {\n            if (alertIds[seen.id]) {\n              alertIds[seen.id].read = true;\n              newSeenAlerts.push({\n                id: seen.id,\n                url: alertIds[seen.id].url\n              });\n            }\n          });\n        }\n        var count = _alerts.length - _seenAlerts.length;\n        var ztickyBar = ZTICKYBAR.init();\n        setUnreadCount(count);\n        window.document.title = count > 0 ? config.title + \" (\" + count + \" unread)\": config.title\n        ztickyBar.setNotificationCount(3, count);\n        setAlerts(_alerts);\n        setSeenAlerts(_seenAlerts);\n        // setRefresh(refresh + 1);\n      })\n      .catch(error => {\n        debugger;\n        errors.push({ context: \"OfficeGraph.getAlerts() \", error });\n        setErrors(errors);\n      });\n  }\n\n  \n  \n  /******************************************************************************************************************************\n   *\n   * Load \n   *\n   ******************************************************************************************************************************/\n  async function getRSS() {\n    var seen = localStorage.getItem(LOCALSTORAGE_SEENALERTS)\n    var _seenAlerts = seen ? JSON.parse(seen) : []\n    var alertIds = {};\n    try {\n      var rss = await axios.get(config.rss)   \n    } catch (error) {\n      errors.push({\n        context: \" OfficeGraph.auth.getAccessToken()\",\n        error\n      });\n      setErrors(errors);\n    }\n   \n   \n\n        var _alerts = rss.data.rss.channel.item.map(alert => {\n          try {\n            var i1 = alert[\"media:content\"]\n            var i2 = i1 ? i1 : null\n            var i3 = i2 ? i2[\"-url\"] : null\n            \n            var x = {\n              id: alert.guid,\n              read:false,\n              title: alert.title,\n              active: true,\n              date: alert.pubDate,\n              message: alert.description,\n              image: i3,\n              url: alert.link\n            };\n            alertIds[alert.guid] = x;\n            return x;\n          } catch (error) {\n            debugger\n            errors.push({ context: \"OfficeGraph.getAlerts() map \", error });\n            setErrors(errors);\n          }\n        });\n        \n        var newSeenAlerts = [];\n        if (_seenAlerts) {\n          _seenAlerts.forEach(seen => {\n            if (alertIds[seen.id]) {\n              alertIds[seen.id].read = true;\n              newSeenAlerts.push({\n                id: seen.id,\n                url: alertIds[seen.id].url\n              });\n            }\n          });\n        }\n        var count = _alerts.length - _seenAlerts.length;\n        var ztickyBar = ZTICKYBAR.init();\n        setUnreadCount(count);\n        window.document.title = count > 0 ? config.title + \" (\" + count + \" unread)\": config.title\n        ztickyBar.setNotificationCount(3, count);\n        setAlerts(_alerts);\n       \n        setSeenAlerts(_seenAlerts);\n        setRefresh(refresh + 1);\n      \n  }\n\n  /******************************************************************************************************************************\n   *\n   * Load already seenalerts\n   *\n   ******************************************************************************************************************************/\n  function getSeenAlerts() {\n    // OfficeGraphOld.myExtentions(\"intranets_seenAlerts\")\n    OfficeGraph.get(\n      accessToken,\n      `https://graph.microsoft.com/v1.0/me/extensions/${config.extensionName}`\n    )\n      .then(extensionData => {\n        try {\n          //console.log(m.value[0].etag);\n          // setSeenAlerts(_seenAlerts);\n          // updateSeenAlerts(_seenAlerts);\n\n          getAlerts(extensionData.seenAlerts);\n        } catch (error) {\n          errors.push({\n            context: \"Post init\",\n            error\n          });\n          setErrors(errors);\n          getAlerts(null);\n        }\n      })\n      .catch(error => {\n        errors.push({\n          context: \"OfficeGraph.myExtentions() \",\n          error\n        });\n        setErrors(errors);\n      });\n  }\n  /******************************************************************************************************************************\n   *\n   * Save seenalerts\n   *\n   ******************************************************************************************************************************/\n  function saveSeenAlerts(_seenAlerts) {\n    if (config.isAnomyous){\n      var seen = JSON.stringify(_seenAlerts)\n      localStorage.setItem(LOCALSTORAGE_SEENALERTS,seen)\n      return new Promise((resolve, reject) => {\n        resolve()\n      })\n      \n    }\n    else{\n    return new Promise(async (resolve, reject) => {\n      var extension = await OfficeGraph.get(\n        accessToken,\n        `https://graph.microsoft.com/v1.0/me/extensions/${config.extensionName}`\n      );\n\n      var method = extension\n        ? OfficeGraph.patch(\n            accessToken,\n            `https://graph.microsoft.com/v1.0/me/extensions/${config.extensionName}`,\n            {\n              \"@odata.type\": \"#microsoft.graph.openTypeExtension\",\n              extensionName: config.extensionName,\n              seenAlerts: _seenAlerts,\n              etag: extension.etag + 1,\n              id: config.extensionName\n            }\n          )\n        : OfficeGraph.post(\n            accessToken,\n            `https://graph.microsoft.com/v1.0/me/extensions`,\n            {\n              \"@odata.type\": \"#microsoft.graph.openTypeExtension\",\n              extensionName: config.extensionName,\n              seenAlerts: _seenAlerts,\n              etag: 1,\n              id:config.extensionName\n            }\n          );\n\n      method\n        .then(extensionData => {\n          try {\n            setRefresh(refresh + 1);\n            resolve();\n          } catch (error) {\n            errors.push({\n              context: \"Post init\",\n              error\n            });\n            setErrors(errors);\n            getAlerts(null);\n            resolve();\n          }\n        })\n        .catch(error => {\n          errors.push({\n            context: \"setSeenAlerts \",\n            error\n          });\n          setErrors(errors);\n          resolve();\n        });\n    });\n  }\n}\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport Alarms from './Alarms';\nimport * as serviceWorker from './serviceWorker';\n\nimport {login} from \"./authenticate\" // autonom library - will force signin\n//import \"./helpers/OfficeGraph\"\n//login()\nReactDOM.render(<Alarms />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","var request = require(\"request\");\n\nvar auth = {};\n\nvar config = {\n  tokenEndpoint: \"https://login.microsoftonline.com/common/oauth2/token\"\n};\n\nauth.getAccessToken = function() {\n  if (window) {\n    throw \"Not valid client side\";\n  }\n  return new Promise((resolve, reject) => {\n    var requestParams = {\n      grant_type: \"client_credentials\",\n      client_id: config.clientId,\n      client_secret: config.clientSecret,\n      resource: \"https://graph.microsoft.com\"\n    };\n\n    request.post(\n      {\n        url: config.tokenEndpoint,\n        form: requestParams\n      },\n      function(err, response, body) {\n        var parsedBody = JSON.parse(body);\n\n        if (err) {\n          reject(err);\n        } else if (parsedBody.error) {\n          reject(parsedBody.error_description);\n        } else {\n          resolve(parsedBody.access_token);\n        }\n      }\n    );\n  });\n};\n\nfunction post2(token, url, body, cb) {\n  request.post(\n    {\n      url: url,\n      headers: {\n        \"content-type\": \"application/json\"\n      },\n      body: JSON.stringify(body)\n    },\n    function(err, response, body) {\n      var parsedBody;\n\n      if (err) {\n        return cb(err);\n      } else {\n        parsedBody = body === \"\" ? {} : JSON.parse(body);\n        if (parsedBody.error) {\n          return cb(parsedBody.error);\n        } else {\n          cb(null, parsedBody);\n        }\n      }\n    }\n  );\n}\n\nfunction post(token, url, body, cb) {\n  request.post(\n    {\n      url: url,\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token\n      },\n      body: JSON.stringify(body)\n    },\n    function(err, response, body) {\n      var parsedBody;\n\n      if (err) {\n        return cb(err);\n      } else {\n        parsedBody = body === \"\" ? {} : JSON.parse(body);\n        if (parsedBody.error) {\n          return cb(parsedBody.error);\n        } else {\n          cb(null, parsedBody);\n        }\n      }\n    }\n  );\n}\nfunction patch(token, url, body, cb) {\n  request.patch(\n    {\n      url: url,\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token\n      },\n      body: JSON.stringify(body)\n    },\n    function(err, response, body) {\n      var parsedBody;\n\n      if (err) {\n        return cb(err);\n      } else {\n        parsedBody = body === \"\" ? {} : JSON.parse(body);\n        if (parsedBody.error) {\n          return cb(parsedBody.error);\n        } else {\n          cb(null, parsedBody);\n        }\n      }\n    }\n  );\n}\n\nfunction get(token, url, cb, appendTo, index, retrycount) {\n  console.log(\"getting\", url, appendTo === true);\n  request.get(\n    {\n      url: url,\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token\n      }\n    },\n    function(err, response, body) {\n      var parsedBody;\n\n      if (err) {\n        var errCounter = retrycount ? retrycount + 1 : 1;\n        if (errCounter > 3) {\n          return cb(err, null, index);\n        } else {\n          // retry\n          console.log(\"retry #\", errCounter);\n          return get(token, url, cb, appendTo, index, errCounter);\n        }\n      }\n\n      parsedBody = JSON.parse(body);\n      if (parsedBody.error) {\n        return cb(parsedBody.error, null, index);\n      }\n\n      if (parsedBody[\"@odata.nextLink\"]) {\n        var data;\n        if (!appendTo) {\n          data = parsedBody.value;\n        } else {\n          data = appendTo.concat(parsedBody.value);\n        }\n\n        return get(token, parsedBody[\"@odata.nextLink\"], cb, data, index);\n      }\n\n      if (appendTo) {\n        cb(null, appendTo.concat(parsedBody.value), index);\n      } else {\n        if (parsedBody.value) {\n          cb(null, parsedBody.value, index);\n        } else {\n          cb(null, parsedBody, index);\n        }\n      }\n    }\n  );\n}\n\nmodule.exports.getRaw = (token, url) => {\n  console.log(\"getting\", url);\n\n  return new Promise((resolve, reject) => {\n    request.get(\n      {\n        url: url,\n        headers: {\n          authorization: \"Bearer \" + token\n        }\n      },\n      function(err, response, body) {\n        if (err) {\n          return resolve({ hasError: true, error: err });\n        }\n        resolve({ hasError: false, result: body });\n      }\n    );\n  });\n};\n\nmodule.exports.get = (token, url) => {\n  return new Promise((resolve, reject) => {\n    get(token, url, (error, result) => {\n      if (error) return reject(error);\n      resolve(result);\n    });\n  });\n};\nmodule.exports.post = (token, url, payload) => {\n  return new Promise((resolve, reject) => {\n    post(token, url, payload, (error, result) => {\n      if (error) return reject(error);\n      resolve(result);\n    });\n  });\n};\nmodule.exports.patch = (token, url, payload) => {\n  return new Promise((resolve, reject) => {\n    patch(token, url, payload, (error, result) => {\n      if (error) return reject(error);\n      resolve(result);\n    });\n  });\n};\n\nmodule.exports.auth = auth;\n"],"sourceRoot":""}